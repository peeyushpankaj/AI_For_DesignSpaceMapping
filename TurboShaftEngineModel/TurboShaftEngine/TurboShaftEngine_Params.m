clear;clc;
combustor_volume = 0.001; % m^3
flow_area = 0.002; % m^2;
shaft_inertia = 0.1; % kg*m^2
mechanical_efficiency = 0.98; % 1

% Compressor Map

compressor.beta_vector = [
     0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0];

compressor.corrected_speed_vector = [
    5000, 6000, 7000, 8000, 8500, 9000, 9500, 10000, 11000, 12000
    ]; % rpm

compressor.map.pressure_ratio = [
    0.1806    0.4817    0.8258    1.1561    1.4451    1.7002    2.0645    2.4086    2.6275    2.7527    2.8903
    0.2364    0.6303    1.0806    1.5128    1.8910    2.2247    2.7014    3.1517    3.4382    3.6019    3.7820
    0.2921    0.7790    1.3354    1.8695    2.3369    2.7493    3.3384    3.8948    4.2489    4.4512    4.6738
    0.4031    1.0748    1.8425    2.5795    3.2244    3.7934    4.6063    5.3740    5.8625    6.1417    6.4488
    0.5503    1.4673    2.5155    3.5216    4.4021    5.1789    6.2886    7.3368    8.0037    8.3849    8.8041
    0.7404    1.9745    3.3849    4.7388    5.9235    6.9688    8.4621    9.8725   10.7700   11.2829   11.8470
    0.9903    2.6407    4.5270    6.3378    7.9222    9.3203   11.3175   13.2037   14.4041   15.0900   15.8445
    1.2261    3.2697    5.6051    7.8472    9.8090   11.5400   14.0129   16.3483   17.8345   18.6838   19.6180
    1.2827    3.4206    5.8639    8.2094   10.2617   12.0726   14.6596   17.1029   18.6577   19.5462   20.5235
    1.3393    3.5715    6.1226    8.5716   10.7145   12.6053   15.3064   17.8575   19.4809   20.4086   21.4290
    ]; % 1

compressor.map.corrected_mass_flow_rate = [
    0.0400    0.0400    0.0400    0.0399    0.0395    0.0389    0.0378    0.0363    0.0349    0.0340    0.0329
    0.0530    0.0530    0.0530    0.0527    0.0521    0.0513    0.0501    0.0481    0.0462    0.0449    0.0434
    0.0640    0.0640    0.0639    0.0635    0.0630    0.0623    0.0611    0.0589    0.0565    0.0549    0.0530
    0.1000    0.1000    0.0997    0.0991    0.0983    0.0974    0.0951    0.0906    0.0870    0.0846    0.0814
    0.1350    0.1350    0.1346    0.1340    0.1332    0.1324    0.1301    0.1258    0.1222    0.1197    0.1165
    0.1700    0.1699    0.1695    0.1688    0.1681    0.1673    0.1654    0.1620    0.1589    0.1562    0.1521
    0.2100    0.2097    0.2089    0.2077    0.2064    0.2051    0.2021    0.1978    0.1925    0.1882    0.1824
    0.2500    0.2498    0.2494    0.2488    0.2480    0.2472    0.2452    0.2414    0.2375    0.2338    0.2287
    0.2600    0.2599    0.2595    0.2589    0.2581    0.2574    0.2555    0.2516    0.2482    0.2453    0.2415
    0.2640    0.2639    0.2635    0.2629    0.2622    0.2616    0.2604    0.2580    0.2558    0.2542    0.2513
    ]; % kg/s

compressor.map.efficiency = [
    0.3500    0.4200    0.4900    0.5600    0.5950    0.6300    0.6650    0.6860    0.6650    0.5600    0.4900
    0.3600    0.4320    0.5040    0.5760    0.6120    0.6480    0.6840    0.7056    0.6840    0.5760    0.5040
    0.3750    0.4500    0.5250    0.6000    0.6375    0.6750    0.7125    0.7350    0.7125    0.6000    0.5250
    0.3900    0.4680    0.5460    0.6240    0.6630    0.7020    0.7410    0.7644    0.7410    0.6240    0.5460
    0.4000    0.4800    0.5600    0.6400    0.6800    0.7200    0.7600    0.7840    0.7600    0.6400    0.5600
    0.4250    0.5100    0.5950    0.6800    0.7225    0.7650    0.8075    0.8330    0.8075    0.6800    0.5950
    0.4500    0.5400    0.6300    0.7200    0.7650    0.8100    0.8550    0.8820    0.8550    0.7200    0.6300
    0.4900    0.5880    0.6860    0.7840    0.8330    0.8820    0.9310    0.9604    0.9310    0.7840    0.6860
    0.4500    0.5400    0.6300    0.7200    0.7650    0.8100    0.8550    0.8820    0.8550    0.7200    0.6300
    0.4000    0.4800    0.5600    0.6400    0.6800    0.7200    0.7600    0.7840    0.7600    0.6400    0.5600
    ]; % 1

compressor.reference_pressure = 0.101325; % MPa
compressor.reference_temperature = 288.15; % K

% Core Turbine Map

turbine.flow_map.pressure_ratio = [
    1.0010, 1.0050, 1.0101, 1.0204, 1.0309, 1.0417, 1.0526, 1.1111, 1.1765, 1.2500, 1.3333, 1.4286, 1.5385, 1.6667, 1.8182, 2.0000
    ]; %  1
turbine.flow_map.corrected_mass_flow_rate = [
    0.0523, 0.1168, 0.1647, 0.2316, 0.2822, 0.3240, 0.3601, 0.4945, 0.5871, 0.6560, 0.7079, 0.7465, 0.7739, 0.7912, 0.7993, 0.8000
    ]; % kg/s

turbine.efficiency_map.pressure_ratio = [1.1111, 1.2500, 1.4286, 1.6667, 2.0000, 2.5000, 3.3333, 5.0000];
turbine.efficiency_map.isentropic_efficiency = [0.7500, 0.8100, 0.8400, 0.8500, 0.8500, 0.8450, 0.8300, 0.8000];

turbine.reference_pressure = 1.5; % MPa
turbine.reference_temperature = 1000; % K

% Power Turbine Map

PT = turbine;
PT.reference_pressure = 0.5; % MPa
PT.reference_temperature = 600; % K


